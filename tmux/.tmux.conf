# Prefix
unbind C-b
set -g prefix C-a 
bind-key C-a last-window
# set -g prefix '\'
# bind-key '\\' send-prefix

# Colors / TrueColor
set -g default-terminal "xterm-256color"
set -as terminal-overrides ',xterm-256color:Tc'

# Neovim friendly
set -sg escape-time 0
set -g focus-events on

# Status bar
set -g status on
set -g status-position bottom
set -g status-interval 1
set -g status-left ""
set -g status-right "#(pomo)"
set -g status-style "fg=#665c54"
set -g status-left-style "fg=#928374"

# Auto-rename to CWD
set -g automatic-rename on
set -g automatic-rename-format '#{b:pane_current_path}'

# Session/Pane/Window index from 1
set -g base-index 1
set -g pane-base-index 1

# Reload
bind -r r source-file ~/.tmux.conf \; display-message "tmux reloaded"

# Clipboard integration (tmux 3.2+ with OSC52-capable terminals)
set -g set-clipboard on

# Mouse mode (in copy mode)
set -g mouse on

# vi-style copy-mode
set -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi Enter send -X copy-selection

# --- clear existing y/Y in copy-mode-vi (optional but clean) ---
unbind -T copy-mode-vi y
unbind -T copy-mode-vi Y

# --- fallback: OSC52 (no external tool) ---
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi Y send -X copy-line

# --- X11: xclip available? override to use xclip ---
if-shell 'command -v xclip >/dev/null 2>&1' \
  'unbind -T copy-mode-vi y; unbind -T copy-mode-vi Y; \
   bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -selection clipboard -in"; \
   bind -T copy-mode-vi Y send -X copy-pipe-and-cancel "xclip -selection clipboard -in"'

# --- Wayland: WAYLAND_DISPLAY set and wl-copy available? override to use wl-copy ---
if-shell 'test -n "#{env:WAYLAND_DISPLAY}" && command -v wl-copy >/dev/null 2>&1' \
  'unbind -T copy-mode-vi y; unbind -T copy-mode-vi Y; \
   bind -T copy-mode-vi y send -X copy-pipe-and-cancel "wl-copy"; \
   bind -T copy-mode-vi Y send -X copy-pipe-and-cancel "wl-copy"'

# --- macOS: override last to use pbcopy ---
if-shell 'uname -s | grep -qi darwin' \
  'unbind -T copy-mode-vi y; unbind -T copy-mode-vi Y; \
   bind -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"; \
   bind -T copy-mode-vi Y send -X copy-pipe-and-cancel "pbcopy"'

# Utility
set -g @plugin 'tmux-plugins/tpm'
run '~/.tmux/plugins/tpm/tpm'
set -g @plugin 'christoomey/vim-tmux-navigator'
